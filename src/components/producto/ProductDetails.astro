---
const { product } = Astro.props;
---

<div class="grid grid-cols-1 md:grid-cols-2 gap-8">
  <!-- ... (resto del contenido) ... -->
  
  <div class="flex items-center space-x-4">
    <div class="flex items-center border rounded-lg overflow-hidden">
      <button id="decrease-qty" class="px-3 py-2 bg-gray-100 hover:bg-gray-200">-</button>
      <input 
        type="number" 
        id="product-quantity" 
        min="1" 
        value="1" 
        class="w-16 text-center border-0 focus:ring-0"
      />
      <button id="increase-qty" class="px-3 py-2 bg-gray-100 hover:bg-gray-200">+</button>
    </div>
    
    <button 
      id="add-to-cart-details"
      class="px-6 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-md"
      data-product={JSON.stringify({
        id: product.id,
        title: product.title,
        price: product.price,
        image: product.image
      })}
    >
      Añadir al carrito
    </button>
  </div>
</div>

<!-- Move this script to a separate JS file and import it with a <script> tag in your main layout, or use an Astro client directive for interactivity. For example: -->
<!-- <YourComponent client:load /> if using a framework component, or: -->

<script is:inline>
  document.addEventListener('DOMContentLoaded', () => {
    if (window.cart) {
      cart.init();
    }

    const quantityInput = document.getElementById('product-quantity');
    const decreaseBtn = document.getElementById('decrease-qty');
    const increaseBtn = document.getElementById('increase-qty');

    function validateQuantity() {
      if (quantityInput.value < 1) quantityInput.value = 1;
    }

    decreaseBtn.addEventListener('click', () => {
      quantityInput.stepDown();
      validateQuantity();
    });

    increaseBtn.addEventListener('click', () => {
      quantityInput.stepUp();
      validateQuantity();
    });

    quantityInput.addEventListener('change', validateQuantity);

    document.getElementById('add-to-cart-details').addEventListener('click', function() {
      const quantity = parseInt(quantityInput.value) || 1;
      const product = JSON.parse(this.dataset.product);

      if (window.cart) {
        cart.add(product, quantity);
        cart.open();

        this.textContent = '¡Añadido!';
        setTimeout(() => {
          this.textContent = 'Añadir al carrito';
        }, 2000);
      }
    });
  });
</script>